{% extends "base.html" %}
{% block title %}Counchin{% endblock %}
{% block content %}
<div class="row">
  <div class='col-md-10 col-md-offset-1'>
    <br>
    {% if lodgments %}

    <br>
    <div class="panel panel-default">
      <div class="panel-heading">Hospedajes</div>
      <table class='table'>
        <tr>
          <th> </th>
          <th> Nombre </th>
          <th> Fecha de inicio </th>
          <th> Fecha de fin </th>
          <th> Puntaje </th>
          <th> Categoria </th>
          <th> Ciudad </th>
          <th> Provincia </th>
          <th> </th>
          <th> </th>
          <th> </th>
        </tr>
        {% for lodgment in lodgments %}
        <tr {% if lodgment.has_donation %}style='background-color:#ffebcd' {% endif %}>
          {% if lodgment.place.gallery.photo_set.all.exists %}
          <td> <img class="thumbnail" src="{{ lodgment.place.gallery.photo_set.first.photo.url }}" /> </td>
          {% else %}
          <td> <img class="thumbnail" src="/media/default-placeholder.png" /> </td>
          {% endif %}
          <td>{{ lodgment.title }}</td>
          <td>{{ lodgment.initial_date }}</td>
          <td>{{ lodgment.finish_date }}</td>
          <td>{{ lodgment.score|floatformat:"0" }}</td>
          <td>{{ lodgment.category }}</td>
          <td>{{ lodgment.place.city }}</td>
          <td>{{ lodgment.place.province }}</td>
          <td><a type='button' href='{% url "lodgment:detail" lodgment.id %}'>Ver</a></td>
          {% if user.is_authenticated %}
            {% if user == lodgment.author %}
              <td><a type='button' href='{% url "lodgment:edit_lodgment" lodgment.id %}'>Editar</a></td>
              <td><a type='button' href='{% url "lodgment:delete_lodgment" lodgment.id %}'>Borrar</a></td>
            {% else %}
            <td><a type='button' href='{% url 'lodgment:new_request' lodgment.id %}'>Solicitar</a></td>
            <td>    </td>
            {% endif %}
          {% endif %}
        </tr>
        {% endfor %}
      </table>
    </div>
    {% else %}
    <p>En este momento no hay hospedajes disponibles.</p>
    {% endif %}
    </ br>
  </div>
  {% endblock %}
